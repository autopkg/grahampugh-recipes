Description: Downloads the current version of The Microsoft Office Removal package.
Identifier: com.github.grahampugh.recipes.download.MicrosoftOfficeRemoval
MinimumVersion: "2.3"

Input:
  NAME: Microsoft Office Removal

Process:
  - Processor: URLTextSearcher
    Arguments:
      re_pattern: (?P<url>https://github.com/cocopuff2u/MOFA/raw/refs/heads/main/office_reset_tools/office_reset_archived/packages/Office-Reset.com_Microsoft_Office_Removal_(?P<version>.*?)\.pkg)
      url: https://mofa.cocolabs.dev/macos_tools/microsoft_office_repair_tools.html

  - Processor: URLDownloader

  - Processor: EndOfCheckPhase

  - Processor: CodeSignatureVerifier
    Arguments:
      expected_authority_names:
        - "Developer ID Installer: Paul Bowden (QGS93ZLCU7)"
        - Developer ID Certification Authority
        - Apple Root CA
      input_path: "%pathname%"
